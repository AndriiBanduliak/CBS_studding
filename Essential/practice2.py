from abc import ABC, abstractmethod
from typing import List


class Observer(ABC):
    """
    –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞.
    –û–≥–æ–ª–æ—à—É—î –º–µ—Ç–æ–¥ update, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å—É–±'—î–∫—Ç–∞–º–∏ –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.
    """
    @abstractmethod
    # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ª–∞–ø–∫–∏ 'Product', —Ç–æ–º—É —â–æ –∫–ª–∞—Å Product —â–µ –Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–æ
    def update(self, product: 'Product') -> None:
        """–û—Ç—Ä–∏–º—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥ –æ–±'—î–∫—Ç–∞ —Ç–æ–≤–∞—Ä—É."""
        pass


class Subject(ABC):
    """
    –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –°—É–±'—î–∫—Ç–∞.
    –û–≥–æ–ª–æ—à—É—î –Ω–∞–±—ñ—Ä –º–µ—Ç–æ–¥—ñ–≤ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∞–º–∏ (—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞–º–∏).
    """
    @abstractmethod
    def attach(self, observer: Observer) -> None:
        """–î–æ–¥–∞—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞ –¥–æ —Å–ø–∏—Å–∫—É."""
        pass

    @abstractmethod
    def detach(self, observer: Observer) -> None:
        """–í–∏–¥–∞–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞ –∑—ñ —Å–ø–∏—Å–∫—É."""
        pass

    @abstractmethod
    def notify(self) -> None:
        """–°–ø–æ–≤—ñ—â–∞—î –≤—Å—ñ—Ö —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á—ñ–≤ –ø—Ä–æ –ø–æ–¥—ñ—ó."""
        pass


class Product(Subject):
    """
    –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–ª–∞—Å –¢–æ–≤–∞—Ä—É, —è–∫–∏–π —Ä–µ–∞–ª—ñ–∑—É—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å Subject.
    –í—ñ–Ω –≤—ñ–¥—Å—Ç–µ–∂—É—î —Å–≤–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥—ñ —Ç–∞ —Å–ø–æ–≤—ñ—â–∞—î –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤,
    –∫–æ–ª–∏ —Ç–æ–≤–∞—Ä –∑–Ω–æ–≤—É –∑'—è–≤–ª—è—î—Ç—å—Å—è –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ.
    """
    def __init__(self, name: str, stock: int = 0):
        self._name = name
        self._stock = stock
        self._observers: List[Observer] = []
        print(f"–°—Ç–≤–æ—Ä–µ–Ω–æ —Ç–æ–≤–∞—Ä: '{self._name}'. –ü–æ—á–∞—Ç–∫–æ–≤–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å: {self._stock}")

    def attach(self, observer: Observer) -> None:
        print(f"–î–æ —Ç–æ–≤–∞—Ä—É '{self._name}' –¥–æ–¥–∞–Ω–æ –Ω–æ–≤–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞.")
        self._observers.append(observer)

    def detach(self, observer: Observer) -> None:
        self._observers.remove(observer)

    def notify(self) -> None:
        """–ó–∞–ø—É—Å–∫–∞—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ –∫–æ–∂–Ω–æ–º—É –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—É."""
        print(f"–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤—Å—ñ—Ö —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á—ñ–≤ –¥–ª—è —Ç–æ–≤–∞—Ä—É '{self._name}'...")
        for observer in self._observers:
            observer.update(self)

    @property
    def name(self) -> str:
        return self._name

    @property
    def stock(self) -> int:
        return self._stock

    @stock.setter
    def stock(self, new_stock: int) -> None:
        """
        –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –Ω–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É.
        –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∑–º—ñ–Ω–∏–ª–∞—Å—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑ 0 –Ω–∞ —â–æ—Å—å –±—ñ–ª—å—à–µ.
        """
        old_stock = self._stock
        self._stock = new_stock
        print(f"–û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∫–ª–∞–¥—É '{self._name}': –±—É–ª–æ {old_stock}, —Å—Ç–∞–ª–æ {self._stock}.")

        # –ö–ª—é—á–æ–≤–∞ —É–º–æ–≤–∞ –∑–∞–≤–¥–∞–Ω–Ω—è: —Å–ø–æ–≤—ñ—â–∞—Ç–∏ –¢–Ü–õ–¨–ö–ò —è–∫—â–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–∏–ª–∞—Å—è –∑ 0 –Ω–∞ >0
        if old_stock == 0 and new_stock > 0:
            print(f"\n>>> –£–í–ê–ì–ê! –¢–æ–≤–∞—Ä '{self._name}' –∑–Ω–æ–≤—É –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ!")
            self.notify()


class Customer(Observer):
    """
    –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–ª–∞—Å –ö–ª—ñ—î–Ω—Ç–∞, —è–∫–∏–π —Ä–µ–∞–ª—ñ–∑—É—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å Observer.
    """
    def __init__(self, name: str, email: str):
        self._name = name
        self._email = email

    def update(self, product: Product) -> None:
        """
        –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ—Ç–æ–¥—É update.
        –í–∏–≤–æ–¥–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –∫–æ–Ω—Å–æ–ª—å, —è–∫ –≤–∏–º–∞–≥–∞–ª–æ—Å—å —É –∑–∞–≤–¥–∞–Ω–Ω—ñ.
        """
        print(f"üì© –ü—Ä–∏–≤—ñ—Ç, {self._name}! –¢–æ–≤–∞—Ä '{product.name}' –∑–Ω–æ–≤—É –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ. –ü–æ—Å–ø—ñ—à–∞–π—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è!")


if __name__ == "__main__":
    # 1. –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–æ–≤–∞—Ä, —è–∫–æ–≥–æ –Ω–µ–º–∞—î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ (0 —à—Ç—É–∫)
    playstation = Product("PlayStation 5", stock=0)
    print("-" * 40)

    # 2. –°—Ç–≤–æ—Ä—é—î–º–æ –∫–ª—ñ—î–Ω—Ç—ñ–≤ (—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á—ñ–≤)
    customer1 = Customer("–û–ª–µ–∫—Å—ñ–π", "alex@example.com")
    customer2 = Customer("–ú–∞—Ä—ñ—è", "maria@example.com")

    # 3. –ö–ª—ñ—î–Ω—Ç–∏ –ø—ñ–¥–ø–∏—Å—É—é—Ç—å—Å—è –Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É
    playstation.attach(customer1)
    playstation.attach(customer2)
    print("-" * 40)

    # 4. –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –û–Ω–æ–≤–ª—é—î–º–æ —Å–∫–ª–∞–¥, –∞–ª–µ —Ç–æ–≤–∞—Ä—É –≤—Å–µ —â–µ –Ω–µ–º–∞—î (0 -> 0)
    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ù–ï –º–∞—î –±—É—Ç–∏
    playstation.stock = 0
    print("-" * 40)

    # 5. –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –¢–æ–≤–∞—Ä –Ω–∞–¥—ñ–π—à–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥ (0 -> 10)
    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ú–ê–Ñ –±—É—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–±–æ–º –∫–ª—ñ—î–Ω—Ç–∞–º
    playstation.stock = 10
    print("-" * 40)

    # 6. –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É –∑–º–µ–Ω—à–∏–ª–∞—Å—å, –∞–ª–µ –≤—ñ–Ω —â–µ —î (10 -> 5)
    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ù–ï –º–∞—î –±—É—Ç–∏
    playstation.stock = 5
    print("-" * 40)

    # 7. –°—Ü–µ–Ω–∞—Ä—ñ–π 4: –¢–æ–≤–∞—Ä –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è (5 -> 0)
    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ù–ï –º–∞—î –±—É—Ç–∏
    playstation.stock = 0
    print("-" * 40)

    # 8. –°—Ü–µ–Ω–∞—Ä—ñ–π 5: –¢–æ–≤–∞—Ä –ó–ù–û–í–£ –Ω–∞–¥—ñ–π—à–æ–≤ (0 -> 3)
    # –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ú–ê–Ñ –±—É—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ
    playstation.stock = 3
    print("-" * 40)
    
 